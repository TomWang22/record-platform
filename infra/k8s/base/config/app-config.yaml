apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  NODE_ENV: development
  NEXT_PUBLIC_GATEWAY_URL: http://localhost:8080

  GATEWAY_PORT: "4000"
  AUTH_PORT: "4001"
  RECORDS_PORT: "4002"
  LISTINGS_PORT: "4003"
  ANALYTICS_PORT: "4004"
  AI_PORT: "5005"

  REDIS_URL: redis://redis.record-platform.svc.cluster.local:6379/0

  PROTO_ROOT: /app/proto

  # EXTERNAL Postgres (Docker) - Direct connection, no K8s service, persistent tuning
  # Connection from K8s pods: Use host.docker.internal:5433 (Docker Compose main DB)
  # CRITICAL: Docker Compose exposes main DB as 5433:5432, so pods must use :5433
  # CRITICAL: auth-service uses POSTGRES_URL_AUTH, so it must point to Docker Postgres with auth schema
  # single source of truth
  DATABASE_URL:         postgresql://postgres:postgres@host.docker.internal:5433/records?connect_timeout=5

  # optional compatibility (literal duplicates, not $(â€¦))
  POSTGRES_URL:         postgresql://postgres:postgres@host.docker.internal:5433/records?connect_timeout=5
  POSTGRES_URL_AUTH:    postgresql://postgres:postgres@host.docker.internal:5433/records?search_path=auth&connect_timeout=5
  POSTGRES_URL_RECORDS: postgresql://postgres:postgres@host.docker.internal:5433/records?connect_timeout=5
  POSTGRES_URL_SOCIAL:  postgresql://postgres:postgres@host.docker.internal:5434/records?connect_timeout=5
  POSTGRES_URL_LISTINGS: postgresql://postgres:postgres@host.docker.internal:5435/records?connect_timeout=5
